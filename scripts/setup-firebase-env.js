#!/usr/bin/env node

/**
 * Helper script to set up Firebase environment variables
 * Run: node scripts/setup-firebase-env.js
 */

const fs = require('fs');
const path = require('path');
const readline = require('readline');

const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout,
});

function question(prompt) {
  return new Promise((resolve) => {
    rl.question(prompt, resolve);
  });
}

async function setup() {
  console.log('\nüî• Firebase Environment Variables Setup\n');
  console.log('Get these values from Firebase Console > Project Settings > Your apps > Web app\n');

  const apiKey = await question('NEXT_PUBLIC_FIREBASE_API_KEY: ');
  const authDomain = await question('NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN: ');
  const projectId = await question('NEXT_PUBLIC_FIREBASE_PROJECT_ID: ');
  const storageBucket = await question('NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET: ');
  const messagingSenderId = await question('NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID: ');
  const appId = await question('NEXT_PUBLIC_FIREBASE_APP_ID: ');

  const envContent = `# Firebase Configuration
# Generated by setup-firebase-env.js

NEXT_PUBLIC_FIREBASE_API_KEY=${apiKey}
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=${authDomain}
NEXT_PUBLIC_FIREBASE_PROJECT_ID=${projectId}
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=${storageBucket}
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=${messagingSenderId}
NEXT_PUBLIC_FIREBASE_APP_ID=${appId}
`;

  const envPath = path.join(process.cwd(), '.env.local');
  
  // Check if file exists
  if (fs.existsSync(envPath)) {
    const overwrite = await question('\n.env.local already exists. Overwrite? (y/n): ');
    if (overwrite.toLowerCase() !== 'y') {
      console.log('Cancelled.');
      rl.close();
      return;
    }
  }

  fs.writeFileSync(envPath, envContent);
  console.log('\n‚úÖ Created .env.local with Firebase configuration!');
  console.log('‚ö†Ô∏è  Make sure to restart your dev server for changes to take effect.\n');
  
  rl.close();
}

setup().catch(console.error);
